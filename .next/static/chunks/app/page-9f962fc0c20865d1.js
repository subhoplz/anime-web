(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2751:(e,t,r)=>{Promise.resolve().then(r.bind(r,5100))},5100:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>em});var s=r(5155),a=r(2115);async function n(){try{let e=await fetch("https://graphql.anilist.co",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"\n    query {\n      Page(page: 1, perPage: 50) {\n        media(type: ANIME, sort: POPULARITY_DESC, status: RELEASING) {\n          id\n          title {\n            romaji\n          }\n          coverImage {\n            large\n          }\n          startDate {\n            year\n            month\n            day\n          }\n          nextAiringEpisode {\n            airingAt\n          }\n        }\n      }\n    }\n  "})}),t=await e.json();if(t.errors)throw console.error("Error fetching anime:",t.errors),Error("Failed to fetch anime from AniList: "+t.errors.map(e=>e.message).join(", "));return t.data.Page.media.map(e=>{let t="Unknown";return e.nextAiringEpisode&&e.nextAiringEpisode.airingAt&&(t=new Date(1e3*e.nextAiringEpisode.airingAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),{id:String(e.id),title:e.title.romaji,coverImage:e.coverImage.large,releaseDate:e.startDate.year?"".concat(e.startDate.year,"-").concat(e.startDate.month,"-").concat(e.startDate.day):"Unknown",releaseTime:t}})}catch(e){throw console.error("Error fetching anime:",e),Error("Failed to fetch anime. Please check the console for details.")}}var i=r(2596),o=r(9688);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,i.$)(t))}let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:l("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});d.displayName="Card";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:l("flex flex-col space-y-1.5 p-6",r),...a})});c.displayName="CardHeader";let f=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:l("text-2xl font-semibold leading-none tracking-tight",r),...a})});f.displayName="CardTitle";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:l("text-sm text-muted-foreground",r),...a})});u.displayName="CardDescription";let m=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:l("p-6 pt-0",r),...a})});m.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:l("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter";var p=r(6766);let g=e=>{let{anime:t,onTrack:r,onUntrack:a,isTracked:n,releaseDateFormatted:i,index:o}=e,l="Unknown";if(t.releaseTime&&"Unknown"!==t.releaseTime)try{let e=t.releaseTime.split(":");if(2===e.length){let[t,r]=e,s=new Date;s.setHours(parseInt(t,10)),s.setMinutes(parseInt(r,10)),l=s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}else l=t.releaseTime}catch(e){console.error("Error formatting time:",e),l=t.releaseTime}return(0,s.jsxs)(d,{className:"w-full md:w-[300px] rounded-lg shadow-md overflow-hidden bg-card text-card-foreground",children:[(0,s.jsxs)(c,{children:[(0,s.jsx)(f,{className:"text-xl font-semibold",children:t.title}),(0,s.jsx)(u,{className:"text-sm text-muted-foreground",children:i}),t.releaseTime&&"Unknown"!==t.releaseTime&&(0,s.jsxs)(u,{className:"text-sm text-muted-foreground",children:["Release Time: ",l]})]}),(0,s.jsxs)(m,{className:"p-4",children:[(0,s.jsx)(p.default,{src:t.coverImage,alt:t.title,width:300,height:450,className:"w-full h-48 object-cover mb-4 rounded",loading:0===o?void 0:"lazy",priority:0===o}),n(t)?(0,s.jsx)("button",{onClick:()=>a(t),className:"w-full bg-secondary hover:bg-secondary/80 text-secondary-foreground font-bold py-2 px-4 rounded mt-2",children:"No, un-track!"}):(0,s.jsx)("button",{onClick:()=>r(t),className:"w-full bg-primary hover:bg-primary/80 text-primary-foreground font-bold py-2 px-4 rounded mt-2",children:"Gotta track 'em all!"})]})]})};var h=r(2085);let x=(0,h.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),v=a.forwardRef((e,t)=>{let{className:r,variant:a,...n}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:l(x({variant:a}),r),...n})});v.displayName="Alert",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:l("mb-1 font-medium leading-none tracking-tight",r),...a})}).displayName="AlertTitle";let b=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:l("text-sm [&_p]:leading-relaxed",r),...a})});b.displayName="AlertDescription";var N=r(9968),y=r(518),j=r(1887),w=r(154),A=r(511),k=r(5318),C=r(5599),S=r(8027),R=r(8763),E=r(1840),T=r(2448),_=r(7270),L=r(8186),U=r(6936),D=r(172),P=r(9637),I=r(4063),F=r(8046),O=r(4301),z=r(5074),M=r(7057),V=r(8271),q=r(7390),W=r(5731),J=r(4956),H=r(1721);let Y={arrowRight:N.A,check:y.A,chevronDown:j.A,circle:w.A,workflow:A.A,close:k.A,copy:C.A,dark:S.A,edit:R.A,externalLink:E.A,file:T.A,help:_.A,home:L.A,light:U.A,loader:D.A,mail:P.A,messageSquare:I.A,plus:F.A,plusCircle:O.A,search:z.A,server:M.A,settings:V.A,share:q.A,shield:W.A,spinner:D.A,trash:J.A,user:H.A},Z=()=>{let[e,t]=(0,a.useState)([]),[r,i]=(0,a.useState)([]),[o,l]=(0,a.useState)(!0),[d,c]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{l(!0),c(null);try{let e=await n();t(e)}catch(e){c(e.message||"Failed to fetch anime.")}finally{l(!1)}})();let e=localStorage.getItem("trackedAnime");e&&i(JSON.parse(e))},[]),(0,a.useEffect)(()=>{localStorage.setItem("trackedAnime",JSON.stringify(r))},[r]);let f=e=>{i([...r,e.id])},u=e=>{i(r.filter(t=>t!==e.id))},m=e=>r.includes(e.id);return o?(0,s.jsx)("p",{children:"Loading..."}):d?(0,s.jsxs)(v,{variant:"destructive",children:[(0,s.jsx)(Y.close,{className:"h-4 w-4"}),(0,s.jsx)(b,{children:d})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:e.map((e,t)=>{let r="Unknown"!==e.releaseDate?new Date(e.releaseDate).toLocaleDateString():"Unknown";return(0,s.jsx)(g,{anime:e,onTrack:f,onUntrack:u,isTracked:m,releaseDateFormatted:r,index:t},e.id)})})};var B=r(7897),G=r(3158);let K=B.bL,X=B.l9;B.YJ,B.ZL,B.Pb,B.z6,a.forwardRef((e,t)=>{let{className:r,inset:a,children:n,...i}=e;return(0,s.jsxs)(B.ZP,{ref:t,className:l("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",r),...i,children:[n,(0,s.jsx)(G.A,{className:"ml-auto"})]})}).displayName=B.ZP.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(B.G5,{ref:t,className:l("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...a})}).displayName=B.G5.displayName;let Q=a.forwardRef((e,t)=>{let{className:r,sideOffset:a=4,...n}=e;return(0,s.jsx)(B.ZL,{children:(0,s.jsx)(B.UC,{ref:t,sideOffset:a,className:l("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...n})})});Q.displayName=B.UC.displayName;let $=a.forwardRef((e,t)=>{let{className:r,inset:a,...n}=e;return(0,s.jsx)(B.q7,{ref:t,className:l("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",r),...n})});$.displayName=B.q7.displayName,a.forwardRef((e,t)=>{let{className:r,children:a,checked:n,...i}=e;return(0,s.jsxs)(B.H_,{ref:t,className:l("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:n,...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(B.VF,{children:(0,s.jsx)(y.A,{className:"h-4 w-4"})})}),a]})}).displayName=B.H_.displayName,a.forwardRef((e,t)=>{let{className:r,children:a,...n}=e;return(0,s.jsxs)(B.hN,{ref:t,className:l("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(B.VF,{children:(0,s.jsx)(w.A,{className:"h-2 w-2 fill-current"})})}),a]})}).displayName=B.hN.displayName,a.forwardRef((e,t)=>{let{className:r,inset:a,...n}=e;return(0,s.jsx)(B.JU,{ref:t,className:l("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",r),...n})}).displayName=B.JU.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(B.wv,{ref:t,className:l("-mx-1 my-1 h-px bg-muted",r),...a})}).displayName=B.wv.displayName;var ee=r(9708);let et=(0,h.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),er=a.forwardRef((e,t)=>{let{className:r,variant:a,size:n,asChild:i=!1,...o}=e,d=i?ee.DX:"button";return(0,s.jsx)(d,{className:l(et({variant:a,size:n,className:r})),ref:t,...o})});er.displayName="Button";var es=r(5977);let ea=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(es.bL,{ref:t,className:l("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...a})});ea.displayName=es.bL.displayName;let en=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(es._V,{ref:t,className:l("aspect-square h-full w-full",r),...a})});en.displayName=es._V.displayName;let ei=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(es.H4,{ref:t,className:l("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...a})});ei.displayName=es.H4.displayName;var eo=r(6874),el=r.n(eo);let ed=()=>(0,s.jsxs)("nav",{className:"bg-background border-b border-border h-16 flex items-center justify-between px-4",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(el(),{href:"/",className:"text-lg font-bold",children:"AniRelease Notifier"})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(er,{variant:"outline",children:(0,s.jsx)(el(),{href:"https://example.com/episodes",children:"Episodes"})}),(0,s.jsx)(er,{variant:"outline",children:(0,s.jsx)(el(),{href:"https://example.com/new-anime",children:"New Anime Release"})}),(0,s.jsxs)(K,{children:[(0,s.jsx)(X,{asChild:!0,children:(0,s.jsx)(er,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,s.jsxs)(ea,{className:"h-8 w-8",children:[(0,s.jsx)(en,{src:"https://github.com/shadcn.png",alt:"@shadcn"}),(0,s.jsx)(ei,{children:"CN"})]})})}),(0,s.jsxs)(Q,{align:"end",children:[(0,s.jsxs)($,{children:[(0,s.jsx)(Y.user,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Profile"})]}),(0,s.jsxs)($,{children:[(0,s.jsx)(Y.settings,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Settings"})]}),(0,s.jsxs)($,{children:[(0,s.jsx)(Y.share,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Invite friends"})]}),(0,s.jsxs)($,{children:[(0,s.jsx)(Y.help,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Support"})]}),(0,s.jsxs)($,{children:[(0,s.jsx)(Y.externalLink,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Terms & Conditions"})]}),(0,s.jsxs)($,{children:[(0,s.jsx)(Y.trash,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Log out"})]})]})]})]})]});var ec=r(4477);let ef=(0,ec.createServerReference)("40b40439a4662eee7bcb48d2c37b1d96c0f9d0f13f",ec.callServer,void 0,ec.findSourceMapURL,"sendNotificationAction"),eu=(0,ec.createServerReference)("4024f2c01897d4c5529830f4217d6c2f79b29d4016",ec.callServer,void 0,ec.findSourceMapURL,"subscribeUser");function em(){let[e,t]=(0,a.useState)(!1),[r,n]=(0,a.useState)(""),[i,o]=(0,a.useState)(!1),[l,d]=(0,a.useState)(null);(0,a.useEffect)(()=>{console.log("[Client] useEffect 1 called!");let e=function(){let e="BBRY9AFP8LZLkoAL85LmMv2MeZPOHWfw7VeFWUqw4yb1qsAT7SeTnibxWoh1UqcNm_7D3WFVPOb1Erw5vnCA0Ak";return e||(console.error("VAPID public key is not configured in environment variables (NEXT_PUBLIC_VAPID_PUBLIC_KEY)."),"")}();n(e),console.log("[Client] VAPID Public Key:",e),o("serviceWorker"in navigator)},[]),(0,a.useEffect)(()=>{console.log("[Client] useEffect 2 called!"),r&&i&&("serviceWorker"in navigator?navigator.serviceWorker.ready.then(async e=>{console.log("[Client] Service Worker Ready");try{let s=await e.pushManager.getSubscription();if(s)console.log("[Client] User is already subscribed."),d(s),t(!0);else{console.log("[Client] No existing subscription, creating a new one..."),s=await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r}),console.log("[Client] New subscription object:",s),d(s);let a=await eu(s);if(console.log("[Client] subscribeUser response:",a),a.success){console.log("[Client] Successfully subscribed on server."),t(!0),console.log("[Client] Sending test notification via Action...");let e=JSON.stringify({title:"Test Notification",body:"You have successfully subscribed!"}),r=await ef(e);console.log("[Client] sendNotificationAction response:",r),r.success?console.log("[Client] Test notification Action sent successfully."):console.error("[Client] Failed to send test notification via Action:",r.error)}else console.error("[Client] Failed to subscribe on the server:",a.error),await s.unsubscribe(),console.log("[Client] Unsubscribed due to server error."),d(null)}}catch(e){console.error("[Client] Error during subscription process:",e)}}).catch(e=>{console.error("[Client] Error during service worker registration:",e)}):console.log("[Client] Service workers are NOT supported in this browser."))},[r,i]);let c=async()=>{if(!l)return void alert("Not subscribed yet!");let e=prompt("Enter notification message:");if(e){console.log("[Client] Manually sending notification via Action...");let t=JSON.stringify({title:"Manual Notification",body:e}),r=await ef(t);r.success?alert("Notification sent!"):alert("Failed to send notification: ".concat(r.error))}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ed,{}),(0,s.jsxs)("div",{className:"container mx-auto py-10",children:[(0,s.jsxs)("section",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Most Trending Anime"}),(0,s.jsx)(Z,{})]}),(0,s.jsx)("section",{className:"mt-8",children:i?e?(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"You are subscribed to notifications."}),(0,s.jsx)("button",{onClick:c,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-700",children:"Send Manual Notification"})]}):(0,s.jsx)("p",{children:"Subscribing to notifications..."}):(0,s.jsx)("p",{children:"Service Workers are not supported by your browser. Notifications unavailable."})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[324,441,684,358],()=>t(2751)),_N_E=e.O()}]);